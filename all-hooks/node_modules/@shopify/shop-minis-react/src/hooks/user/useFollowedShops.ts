import {useMemo} from 'react'

import {useShopActions} from '../../internal/useShopActions'
import {useShopActionsPaginatedDataFetching} from '../../internal/useShopActionsPaginatedDataFetching'
import {
  PaginatedDataHookOptionsBase,
  PaginatedDataHookReturnsBase,
  Shop,
} from '../../types'

export interface UseFollowedShopsParams extends PaginatedDataHookOptionsBase {}

interface UseFollowedShopsReturns extends PaginatedDataHookReturnsBase {
  /**
   * The followed shops returned from the query.
   */
  shops: Shop[] | null
}

export const useFollowedShops = (
  params?: UseFollowedShopsParams
): UseFollowedShopsReturns => {
  const {getFollowedShops} = useShopActions()
  const {skip = false, ...restParams} = params ?? {}

  const {data, ...rest} = useShopActionsPaginatedDataFetching(
    getFollowedShops,
    restParams,
    {
      skip,
      hook: 'useFollowedShops',
    }
  )

  const shops = useMemo(() => {
    return data ?? null
  }, [data])

  return {
    ...rest,
    shops,
  }
}
