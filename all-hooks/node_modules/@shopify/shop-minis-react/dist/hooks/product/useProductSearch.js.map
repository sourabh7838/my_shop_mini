{"version":3,"file":"useProductSearch.js","sources":["../../../src/hooks/product/useProductSearch.ts"],"sourcesContent":["import {useCallback, useEffect, useMemo, useState} from 'react'\n\nimport debounce from 'lodash/debounce'\n\nimport {useShopActions} from '../../internal/useShopActions'\nimport {useShopActionsPaginatedDataFetching} from '../../internal/useShopActionsPaginatedDataFetching'\nimport {\n  PaginatedDataHookOptionsBase,\n  PaginatedDataHookReturnsBase,\n  Product,\n  ProductFilters,\n  ProductSearchSortBy,\n} from '../../types'\n\nexport interface UseProductSearchParams extends PaginatedDataHookOptionsBase {\n  /**\n   * The search query.\n   */\n  query: string\n  /**\n   * The filters to apply to the search.\n   */\n  filters?: ProductFilters\n  /**\n   * The sort order of the results.\n   */\n  sortBy?: ProductSearchSortBy\n  /**\n   * Whether to include sensitive products.\n   */\n  includeSensitive?: boolean\n}\n\ninterface UseProductSearchReturns extends PaginatedDataHookReturnsBase {\n  /**\n   * The products returned from the query.\n   */\n  products: Product[] | null\n}\n\nexport const useProductSearch = (\n  params: UseProductSearchParams\n): UseProductSearchReturns => {\n  const {getProductSearch} = useShopActions()\n  const {\n    query,\n    filters,\n    sortBy,\n    includeSensitive = false,\n    skip = false,\n    ...restParams\n  } = params ?? {}\n\n  const [debouncedQuery, setDebouncedQuery] = useState<string>(query)\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const debouncedSetQuery = useCallback(\n    debounce((newQuery: string) => {\n      setDebouncedQuery(newQuery)\n    }, 300),\n    []\n  )\n\n  useEffect(() => {\n    debouncedSetQuery(query)\n\n    return () => {\n      debouncedSetQuery.cancel()\n    }\n  }, [query, debouncedSetQuery])\n\n  const {data, ...rest} = useShopActionsPaginatedDataFetching(\n    getProductSearch,\n    {\n      query: debouncedQuery,\n      filters,\n      sortBy,\n      includeSensitive,\n      ...restParams,\n    },\n    {\n      skip,\n      hook: 'useProductSearch',\n    }\n  )\n\n  const products = useMemo(() => {\n    return data ?? null\n  }, [data])\n\n  return {\n    ...rest,\n    products,\n  }\n}\n"],"names":["useProductSearch","params","getProductSearch","useShopActions","query","filters","sortBy","includeSensitive","skip","restParams","debouncedQuery","setDebouncedQuery","useState","debouncedSetQuery","useCallback","debounce","newQuery","useEffect","data","rest","useShopActionsPaginatedDataFetching","products","useMemo"],"mappings":";;;;AAwCa,MAAAA,IAAmB,CAC9BC,MAC4B;AACtB,QAAA,EAAC,kBAAAC,EAAgB,IAAIC,EAAe,GACpC;AAAA,IACJ,OAAAC;AAAA,IACA,SAAAC;AAAA,IACA,QAAAC;AAAA,IACA,kBAAAC,IAAmB;AAAA,IACnB,MAAAC,IAAO;AAAA,IACP,GAAGC;AAAA,EACL,IAAIR,KAAU,CAAC,GAET,CAACS,GAAgBC,CAAiB,IAAIC,EAAiBR,CAAK,GAG5DS,IAAoBC;AAAA,IACxBC,EAAS,CAACC,MAAqB;AAC7B,MAAAL,EAAkBK,CAAQ;AAAA,OACzB,GAAG;AAAA,IACN,CAAA;AAAA,EACF;AAEA,EAAAC,EAAU,OACRJ,EAAkBT,CAAK,GAEhB,MAAM;AACX,IAAAS,EAAkB,OAAO;AAAA,EAC3B,IACC,CAACT,GAAOS,CAAiB,CAAC;AAE7B,QAAM,EAAC,MAAAK,GAAM,GAAGC,EAAA,IAAQC;AAAA,IACtBlB;AAAA,IACA;AAAA,MACE,OAAOQ;AAAA,MACP,SAAAL;AAAA,MACA,QAAAC;AAAA,MACA,kBAAAC;AAAA,MACA,GAAGE;AAAA,IACL;AAAA,IACA;AAAA,MACE,MAAAD;AAAA,MACA,MAAM;AAAA,IAAA;AAAA,EAEV,GAEMa,IAAWC,EAAQ,MAChBJ,KAAQ,MACd,CAACA,CAAI,CAAC;AAEF,SAAA;AAAA,IACL,GAAGC;AAAA,IACH,UAAAE;AAAA,EACF;AACF;"}