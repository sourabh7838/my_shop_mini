import { Command } from 'commander';
import { renderError, renderSuccess } from '@shopify/cli-kit/node/ui';
import { handler as handleError } from '@shopify/cli-kit/node/error';
import { secretDelete } from '../../data/secrets/secret-delete.js';
import { assertNetworkAndAuth } from '../../utils/common-tasks.js';
import { getRunBinCommand } from '../../utils/package-manager.js';
export const command = new Command()
    .name('delete')
    .description('Delete a secret.')
    .argument('<secret key>', 'The key of the secret to delete.')
    .action(async (secretKeyArg) => {
    try {
        if (!secretKeyArg) {
            const exampleCommand = await getRunBinCommand('shop-minis secrets delete my-secret-key');
            renderError({
                headline: 'Missing secret key',
                body: [
                    'Please provide a secret key.\nExample:',
                    {
                        bold: exampleCommand,
                    },
                ],
            });
            return;
        }
        await assertNetworkAndAuth();
        const { userErrors } = await secretDelete({
            key: secretKeyArg,
        });
        if (userErrors.length > 0) {
            renderError({
                headline: 'Error deleting a secret',
                body: userErrors.map(error => error.message),
            });
        }
        else {
            renderSuccess({
                headline: 'Secret deleted',
                body: [
                    'Secret key',
                    {
                        bold: secretKeyArg,
                    },
                    'has been deleted from your Shop Mini.',
                ],
            });
        }
    }
    catch (error) {
        handleError(error);
    }
});
//# sourceMappingURL=delete.js.map