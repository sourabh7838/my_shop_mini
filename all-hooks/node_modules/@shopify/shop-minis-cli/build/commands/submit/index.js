import { Command } from 'commander';
import { outputDebug } from '@shopify/cli-kit/node/output';
import { getMiniManifest } from '../../utils/minis-manifest.js';
import { codeBuildChecks, completeConfig, doSubmit, preSubmitChecks, } from './submit.js';
export function loadCommand(parentProgram) {
    const command = new Command()
        .name('submit')
        .description('Submit your Shop Mini for review.')
        .option('--description [description]', 'A description of the changes in this submission.')
        .option('--verbose', 'Print debugging messages.') // compatible with cli-kit
        .action(async (args) => {
        const miniName = getMiniManifest().name;
        outputDebug(`Submit args ${JSON.stringify(args)}`);
        outputDebug(`Submitting mini "${miniName}" at ${process.cwd()}`);
        const continueWithSubmission = await codeBuildChecks();
        if (!continueWithSubmission) {
            process.exit(0);
        }
        await preSubmitChecks();
        const config = await completeConfig(args);
        await doSubmit(config);
    });
    parentProgram.addCommand(command);
}
//# sourceMappingURL=index.js.map