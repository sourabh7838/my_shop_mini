import { readFileSync, writeFileSync } from 'node:fs';
import path from 'node:path';
import { SemVer } from 'semver';
async function applyUpgrade() {
    const manifestFilePath = path.join(process.cwd(), 'src', 'manifest.json');
    const manifestFileContent = readFileSync(manifestFilePath, {
        encoding: 'utf-8',
    });
    const manifest = JSON.parse(manifestFileContent);
    const shopifyAppIds = manifest.shopify_app_ids;
    if (!shopifyAppIds) {
        return;
    }
    delete manifest.shopify_app_ids;
    const shopifyApps = { production: undefined, development: [] };
    shopifyAppIds?.forEach((shopifyAppId) => {
        if ([
            1385675, 352999, 3182901, 9922478081, 4539653, 3031907, 3488405,
            4339901,
        ].includes(shopifyAppId)) {
            shopifyApps.production = shopifyAppId;
        }
        else {
            shopifyApps.development.push(shopifyAppId);
        }
    });
    manifest.shopify_apps = shopifyApps;
    writeFileSync(manifestFilePath, `${JSON.stringify(manifest, null, 2)}\n`, {
        encoding: 'utf8',
    });
}
const releaseNotes = [
    'Convert shopify_app_ids to the new shopify_apps field in manifest.json',
];
const exports = {
    releaseNotes,
    applyUpgrade,
    version: new SemVer('0.0.57'),
};
export default exports;
//# sourceMappingURL=v0-0-57.js.map