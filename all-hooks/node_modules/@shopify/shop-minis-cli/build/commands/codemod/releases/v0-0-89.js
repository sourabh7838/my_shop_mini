import fs from 'node:fs';
import path from 'node:path';
import { SemVer } from 'semver';
/**
 * Re-introduce <SafeAreaView /> to the blank template
 *
 * This will not apply to real minis and is mostly for the sake of testing
 *
 * Diff: https://github.com/Shopify/shop-minis-cli/compare/v0.0.88...v0.0.89
 */
async function applyUpgrade() {
    const existingAppTsxPath = path.join(process.cwd(), 'src', 'App.tsx');
    let existingAppTsxContent = null;
    try {
        existingAppTsxContent = fs.readFileSync(existingAppTsxPath, {
            encoding: 'utf-8',
        });
    }
    catch (error) {
        // If the App.tsx file doesn't exist or is unreadable for some reason, we don't need to do anything
        return;
    }
    // Only apply the upgrade if the App.tsx file is still the old blank template
    if (existingAppTsxContent === oldBlankTemplateAppContent) {
        fs.writeFileSync(existingAppTsxPath, newBlankTemplateAppContent, {
            encoding: 'utf-8',
        });
    }
}
const releaseNotes = ['Add <SafeAreaView /> to the blank template'];
const oldBlankTemplateAppContent = `import {Box, Text} from '@shopify/shop-minis-platform-sdk'

export function App() {
  return (
    <Box flex={1} padding="m" backgroundColor="backgrounds-regular">
      <Text textAlign="center">Fill in the blank</Text>
    </Box>
  )
}
`;
const newBlankTemplateAppContent = `import {SafeAreaView} from 'react-native'
import {Box, Text} from '@shopify/shop-minis-platform-sdk'

export function App() {
  return (
    <SafeAreaView style={{flex: 1}}>
      <Box flex={1} padding="m" backgroundColor="backgrounds-regular">
        <Text textAlign="center">Fill in the blank</Text>
      </Box>
    </SafeAreaView>
  )
}
`;
const exports = {
    releaseNotes,
    applyUpgrade,
    version: new SemVer('0.0.89'),
};
export default exports;
//# sourceMappingURL=v0-0-89.js.map