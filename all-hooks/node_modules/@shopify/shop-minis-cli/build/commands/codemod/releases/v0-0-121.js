import fs from 'node:fs';
import path from 'node:path';
import { SemVer } from 'semver';
/**
 * Diff: https://github.com/Shopify/shop-minis-cli/compare/v0.0.120...v0.0.121
 */
async function applyUpgrade() {
    if (process.env.INTERNAL_CODEMODS) {
        const existingAppTsxPath = path.join(process.cwd(), 'src', 'App.tsx');
        let existingAppTsxContent = null;
        try {
            existingAppTsxContent = fs.readFileSync(existingAppTsxPath, {
                encoding: 'utf-8',
            });
        }
        catch (error) {
            // If the App.tsx file doesn't exist or is unreadable for some reason, we don't need to do anything
            return;
        }
        // Only apply the upgrade if the App.tsx file is still the old blank template
        if (existingAppTsxContent === oldBlankTemplateAppContent) {
            fs.writeFileSync(existingAppTsxPath, newBlankTemplateAppContent, {
                encoding: 'utf-8',
            });
        }
    }
}
const oldBlankTemplateAppContent = `import {StatusBar} from 'react-native'
import {Box, Text, SafeAreaView} from '@shopify/shop-minis-platform-sdk'

export function App() {
  return (
    <Box flex={1} backgroundColor="backgrounds-regular">
      <StatusBar barStyle="dark-content" />
      <SafeAreaView style={{flex: 1, justifyContent: 'center'}}>
        <Text textAlign="center">Fill in the blank</Text>
      </SafeAreaView>
    </Box>
  )
}
`;
const newBlankTemplateAppContent = `import {StatusBar} from 'react-native'
import {
  Box,
  Text,
  SafeAreaView,
  useMinisParams,
} from '@shopify/shop-minis-platform-sdk'

export function App() {
  const {extensionData} = useMinisParams()
  return (
    <Box flex={1} backgroundColor="backgrounds-regular">
      <StatusBar barStyle="dark-content" />
      <SafeAreaView style={{flex: 1, justifyContent: 'center'}}>
        <Text textAlign="center">Fill in the blank</Text>
        {extensionData ? (
          <Text textAlign="center">
            Data from the extension: {JSON.stringify(extensionData)}
          </Text>
        ) : null}
      </SafeAreaView>
    </Box>
  )
}
`;
const releaseNotes = ['Add extensionData usage to the blank template'];
const exports = {
    releaseNotes,
    applyUpgrade,
    version: new SemVer('0.0.121'),
};
export default exports;
//# sourceMappingURL=v0-0-121.js.map