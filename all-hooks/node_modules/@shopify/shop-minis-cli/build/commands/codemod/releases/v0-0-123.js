import { readFile, writeFile } from 'node:fs/promises';
import path from 'node:path';
import { SemVer } from 'semver';
/**
 * Diff: https://github.com/Shopify/shop-minis-cli/compare/v0.0.122...v0.0.123
 */
async function applyUpgrade() {
    if (process.env.INTERNAL_CODEMODS) {
        // we don't want to delete these scripts in existing minis as partners might be already relying on them
        const packageJsonPath = path.join(process.cwd(), 'package.json');
        const packageJsonString = await readFile(packageJsonPath, {
            encoding: 'utf-8',
        });
        const packageJson = JSON.parse(packageJsonString) || {};
        delete packageJson.scripts.submit;
        delete packageJson.scripts['cancel-submission'];
        delete packageJson.scripts['check-submission'];
        delete packageJson.scripts['generate-graphql-types'];
        // persist updated package.json
        await writeFile(packageJsonPath, `${JSON.stringify(packageJson, null, 2)}\n`, // keep the new line at the end of the file
        {
            encoding: 'utf-8',
        });
    }
}
const releaseNotes = [];
const exports = {
    releaseNotes,
    applyUpgrade,
    version: new SemVer('0.0.123'),
};
export default exports;
//# sourceMappingURL=v0-0-123.js.map