import fs from 'node:fs';
import path from 'node:path';
import { SemVer } from 'semver';
/**
 * Move development config of the Mini from index.tsx in the rootpath to shop-minis-runtime
 *
 * Diff: https://github.com/Shopify/shop-minis-cli/compare/v0.0.91...v0.0.92
 */
async function applyUpgrade() {
    const indexTsxPath = path.join(process.cwd(), 'index.tsx');
    try {
        fs.writeFileSync(indexTsxPath, 
        // for internal codemod we want sandbox to be true so that it matches the value used in starting templates
        // for real partners, we want to set sandbox to false because we assume they are already using their API_KEY
        getIndexFileContent(process.env.INTERNAL_CODEMODS ? 'true' : 'false'), {
            encoding: 'utf-8',
        });
    }
    catch (error) {
        // If index.tsx doesn't exist or is unreadable for some reason, we don't need to do anything
    }
}
const getIndexFileContent = (enableApiSandbox) => `import {renderDevelopmentMini} from '@shopify/shop-minis-runtime/src/utils/renderDevelopmentMini'

import MiniApp from './src'

renderDevelopmentMini(MiniApp.Root, {enableApiSandbox: ${enableApiSandbox}})
`;
const releaseNotes = [
    'Move development config of the Mini from index.tsx in the rootpath to shop-minis-runtime',
];
const exports = {
    releaseNotes,
    applyUpgrade,
    version: new SemVer('0.0.92'),
};
export default exports;
//# sourceMappingURL=v0-0-92.js.map