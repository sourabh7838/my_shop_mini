import path from 'node:path';
import fs from 'node:fs';
import { SemVer } from 'semver';
/**
 * Diff: https://github.com/Shopify/shop-minis-cli/compare/v0.0.78...v0.0.79
 */
async function applyUpgrade() {
    if (process.env.INTERNAL_CODEMODS) {
        const manifestJsonPath = path.join(process.cwd(), 'src/manifest.json');
        const manifestJsonString = fs.readFileSync(manifestJsonPath, {
            encoding: 'utf-8',
        });
        const manifestJson = JSON.parse(manifestJsonString) || {};
        delete manifestJson.handle;
        fs.writeFileSync(manifestJsonPath, `${JSON.stringify(manifestJson, null, 2)}\n`, {
            encoding: 'utf-8',
        });
    }
    const metroConfigPath = path.join(process.cwd(), 'metro.config.js');
    const metroConfigString = fs.readFileSync(metroConfigPath, {
        encoding: 'utf-8',
    });
    const updatedMetroConfigString = metroConfigString.replace('getMinisMetroConfig()', 'getMinisMetroConfig(__dirname)');
    fs.writeFileSync(metroConfigPath, updatedMetroConfigString, {
        encoding: 'utf-8',
    });
}
const releaseNotes = ['Updates metro-config.js'];
const exports = {
    releaseNotes,
    applyUpgrade,
    version: new SemVer('0.0.79'),
};
export default exports;
//# sourceMappingURL=v0-0-79.js.map